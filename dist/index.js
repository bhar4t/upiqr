import QRCode from"qrcode";function validate({pa:e,pn:t}){if(!e||!t)return"Virtual payee's address/name is compulsory";if(e.length<5||t.length<4)return"Virtual payee's address/name is too short.";return""}export default function upiqr({payeeVPA:e,payeeName:t,payeeMerchantCode:r,transactionId:n,transactionRef:a,transactionNote:o,amount:i,minimumAmount:c,currency:s},u){const m={pa:e,pn:t,am:i,mam:c,cu:s,mc:r,tid:n,tr:a,tn:o};const p=validate(m);if(p)return Promise.reject(new Error(p));const d=(e=>{const t=new URLSearchParams(Object.entries(e).filter(([e,t])=>t));return`upi://pay?${t.toString()}`})(m);return new Promise((t,r)=>{QRCode.toDataURL(d,u).then(e=>t({qr:e,intent:d})).catch(e=>r(new Error("Unable to generate UPI QR Code.\n"+e)))})}