import QRCode from"qrcode";function validate({pa:e,pn:t}){if(!e||!t)return"Virtual payee's address/name is compulsory";if(e.length<5||t.length<4)return"Virtual payee's address/name is too short.";return""}export default function upiqr({payeeVPA:e,payeeName:t,payeeMerchantCode:n,transactionId:r,transactionRef:a,transactionNote:o,amount:i,minimumAmount:c,currency:s},u){const m={pa:e,pn:t,am:i,mam:c,cu:s,mc:n,tid:r,tr:a,tn:o};const p=validate(m);if(p)return Promise.reject(new Error(p));const d=(e=>{const t=new URLSearchParams;for(const[n,r]of Object.entries(e)){if(r)t.append(n,r)}return`upi://pay?${t.toString()}`})(m);return new Promise((t,n)=>{QRCode.toDataURL(d,u).then(e=>t({qr:e,intent:d})).catch(e=>n(new Error("Unable to generate UPI QR Code.\n"+e)))})}